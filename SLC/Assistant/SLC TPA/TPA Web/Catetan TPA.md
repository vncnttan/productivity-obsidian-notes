![[Pasted image 20230719144401.png]]

Jadi nanti Tokennya bakal dimasukkin ke Header
Terus Token yang diambil dari header, kalo login bakal dijadiin context
Terus Contextnya dipake buat autentikasi middleware

[A guide to JWT authentication in Go - LogRocket Blog](https://blog.logrocket.com/jwt-authentication-go/)

Notes, kalo export harus pake kapital


```go
package graph  
  
// This file will be automatically regenerated based on the schema, any resolver implementations  
// will be copied through when generating and any unknown code will be moved to the end.  
// Code generated by github.com/99designs/gqlgen version v0.17.35  
  
import (  
"backend/graph/model"  
"backend/helper"  
"context"  
"fmt"  
"github.com/golang-jwt/jwt"  
"github.com/google/uuid"  
)  
  
// CreateUser is the resolver for the createUser field.func (r *mutationResolver) CreateUser(ctx context.Context, inputUser *model.NewUser) (*model.User, error) {  
user := &model.User{  
ID: uuid.NewString(),  
Name: inputUser.Name,  
Email: inputUser.Email,  
Password: inputUser.Password,  
Username: inputUser.Username,  
}  
  
return user, r.DB.Save(&user).Error  
}  
  
// UpdateUser is the resolver for the updateUser field.func (r *mutationResolver) UpdateUser(ctx context.Context, id string, inputUser *model.NewUser) (*model.User, error) {  
var user *model.User  
  
if err := r.DB.First(&user, "id = ?", id).Error; err != nil {  
return nil, err  
}  
  
user.Name = inputUser.Name  
user.Email = inputUser.Email  
user.Password = inputUser.Password  
user.Username = inputUser.Username  
  
return user, r.DB.Save(&user).Error  
}  
  
// DeleteUser is the resolver for the deleteUser field.func (r *mutationResolver) DeleteUser(ctx context.Context, id string) (*model.User, error) {  
var user *model.User  
  
if err := r.DB.First(&user, "id = ?", id).Error; err != nil {  
return nil, err  
}  
  
return user, r.DB.Delete(&user).Error  
}  
  
// GetUser is the resolver for the getUser field.func (r *queryResolver) GetUser(ctx context.Context, id string) (*model.User, error) {  
var user *model.User  
return user, r.DB.First(&user, "id = ?", id).Error  
}  
  
// GetAllUser is the resolver for the getAllUser field.func (r *queryResolver) GetAllUser(ctx context.Context) ([]*model.User, error) {  
var users []*model.User  
return users, r.DB.Find(&users).Error  
}  
  
// Login is the resolver for the login field.func (r *queryResolver) Login(ctx context.Context, username string, password string) (string, error) {  
var credentials model.Credentials  
userInDB, err := r.GetUser(ctx, username)  
  
if err != nil {  
return "", err  
}  
  
if userInDB.Password != password {  
return "", err  
}  
  
claims := model.Claims{  
Username: credentials.Username,  
StandardClaims: jwt.StandardClaims{},  
}  
  
token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)  
tokenString, err := token.SignedString(helper.GoDotEnvVariable("SECRET_KEY"))  
  
if err != nil {  
return "", err  
}  
  
return tokenString, err  
}  
  
// Mutation returns MutationResolver implementation.func (r *Resolver) Mutation() MutationResolver { return &mutationResolver{r} }  
  
// Query returns QueryResolver implementation.func (r *Resolver) Query() QueryResolver { return &queryResolver{r} }  
  
type mutationResolver struct{ *Resolver }  
type queryResolver struct{ *Resolver }
```

// GetUser is the resolver for the getUser field.func (r *queryResolver) GetUser(ctx context.Context, id string) (*model.User, error) {  
var user *model.User  
return user, r.DB.First(&user, "username = ?").Error  
}  
  
// GetAllUser is the resolver for the getAllUser field.func (r *queryResolver) GetAllUser(ctx context.Context) ([]*model.User, error) {  
var users []*model.User  
return users, r.DB.Find(&users).Error  
}